<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hicham Market</title>
<style>
body {margin:0;font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;background-color:#111;color:#fff;}
header {background-color:#000;padding:20px;text-align:center;position:sticky;top:0;z-index:100;}
header h1 {color:gold;margin:0;}
nav {margin-top:10px;}
nav a {color:#fff;text-decoration:none;margin:0 15px;font-weight:bold;}
nav a:hover {color:gold;}
.banner {background:url('https://via.placeholder.com/1200x400') no-repeat center/cover;height:400px;display:flex;align-items:center;justify-content:center;font-size:2rem;font-weight:bold;color:gold;}
.product-section {padding:50px 20px;text-align:center;}
.product-section img.main {width:300px;border:3px solid gold;border-radius:10px;}
.product-section h2 {margin:20px 0 10px 0;font-size:2rem;color:gold;}
.product-section p {font-size:1.2rem;color:#ddd;}
.price {font-size:1.5rem;color:gold;margin:10px 0;}
.add-cart-btn {background-color:gold;border:none;padding:10px 20px;font-size:1rem;cursor:pointer;border-radius:5px;color:#000;margin-bottom:20px;}
.gallery {display:flex;justify-content:center;gap:10px;flex-wrap:wrap;}
.gallery img {width:150px;border:2px solid gold;border-radius:5px;cursor:pointer;transition:transform 0.3s;}
.gallery img:hover {transform:scale(1.05);}
.cart {position:fixed;top:20px;right:20px;background-color:gold;color:#000;padding:10px 15px;border-radius:5px;cursor:pointer;font-weight:bold;}

/* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ© */
.checkout-modal {position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.8);display:none;justify-content:center;align-items:center;z-index:1000;}
.checkout-content {background:#1c1c1c;padding:40px;border-radius:15px;width:90%;max-width:450px;box-shadow:0 8px 25px rgba(0,0,0,0.5);animation:fadeIn 0.4s ease-in-out;}
@keyframes fadeIn {from {opacity:0;transform:scale(0.95);} to {opacity:1;transform:scale(1);}}
.checkout-content h3 {color:gold;text-align:center;margin-bottom:30px;font-size:1.8rem;}
.form-group {margin-bottom:20px;display:flex;flex-direction:column;}
.form-group label {color:#fff;margin-bottom:5px;font-weight:bold;}
.form-group input, .form-group textarea {padding:12px;border-radius:8px;border:1px solid #444;background-color:#2a2a2a;color:#fff;font-size:1rem;transition:border 0.3s, box-shadow 0.3s;}
.form-group input:focus, .form-group textarea:focus {border:1px solid gold;box-shadow:0 0 8px gold;outline:none;}
.submit-btn {width:100%;padding:15px;background:gold;color:#000;font-size:1.2rem;border:none;border-radius:10px;font-weight:bold;cursor:pointer;transition:transform 0.2s, background 0.2s;}
.submit-btn:hover {transform:scale(1.05);background:#e6c200;}

/* Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠ */
.social-icons {margin-top:15px;display:flex;justify-content:center;gap:20px;}
.social-icons .icon {width:40px;height:40px;transition:transform 0.3s;}
.social-icons .icon:hover {transform:scale(1.2);}
/* Order success modal */
.success-modal {position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);display:none;justify-content:center;align-items:center;z-index:1100}
.success-content {background:linear-gradient(180deg,#0f172a,#111827);color:#fff;padding:30px;border-radius:14px;max-width:420px;width:90%;text-align:center;box-shadow:0 10px 30px rgba(0,0,0,0.6)}
.success-content h4 {color:gold;margin:0 0 10px 0;font-size:1.4rem}
.success-content p {color:#e5e7eb;margin:10px 0;font-size:1rem}
.success-btn {margin-top:16px;padding:10px 18px;background:gold;color:#000;border:none;border-radius:10px;font-weight:700;cursor:pointer}
</style>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

</head>
<body>

<header>
<h1>Hicham Market</h1>
<nav>
<a href="#home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
<a href="#product">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</a>
<a href="#about">Ø­ÙˆÙ„</a>
<a href="#contact">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
  <!-- Link to admin panel -->
  <a href="stale.html" target="_blank" style="color:gold;margin-left:15px;font-weight:normal;border:1px solid gold;padding:6px 10px;border-radius:6px;">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
</nav>
</header>

<div class="banner" id="home">
Ø§ÙƒØªØ´Ù Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
</div>

<section class="product-section" id="product">
<img src="download_61.jpg" alt="Ù…Ù†ØªØ¬" class="main">
<h1>Ø§Ù„ØªÙˆØ§ØµÙ„ Ø¨Ø§Ù„Ù…Ø¬Ø§Ù† ğŸšš</h1>
<h2>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</h2>
<p>Ø­Ø§Ù…Ù„ Ù‡Ø§ØªÙ ØµØ¯Ø±ÙŠ ÙŠÙ‚ÙˆÙ… Ø¨ØªØªØ¨ÙŠØª Ø§Ù„Ù‡Ø§ØªÙ Ø§ØªÙ†Ø§Ø¡ Ø±ÙƒÙˆØ¨Ùƒ Ø§Ù„Ø¯Ø±Ø§Ø¬Ø© Ø§Ùˆ Ø§Ù„Ù…Ø´ÙŠ Ø§Ùˆ Ù…Ù…Ø§Ø±Ø³Øª Ø§ÙŠ Ø±ÙŠØ§Ø¶Ø©.</p>
<div class="price">149 Ø¯Ø±Ù‡Ù…</div>
<button class="add-cart-btn" onclick="openCheckout()">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø§Ù†</button>

<div class="gallery">
<img src="download_65.webp" alt="ØµÙˆØ±Ø© 1">
<img src="download_63.webp" alt="ØµÙˆØ±Ø© 2">
<img src="Harnais-de-Fixation-Poitrine-pour-GoPro-Hero-6-5-black-4-3-3-2-1-Sangle-Poitrine-Camera-Gopro.jpg" alt="ØµÙˆØ±Ø© 3">
</div>
</section>

<div class="cart" onclick="openCheckout()">Ø³Ù„Ø© Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª (1)</div>

<div class="checkout-modal" id="checkoutModal">
<div class="checkout-content">
<h3>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</h3>
<div class="form-group">
<label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
<input type="text" id="name" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
</div>
<div class="form-group">
<label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
<input type="text" id="phone" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
</div>
<div class="form-group">
<label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
<textarea id="address" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù†Ùƒ"></textarea>
</div>
<button class="submit-btn" onclick="submitOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
</div>
</div>

<!-- Success modal shown after order placed -->
<div class="success-modal" id="successModal">
  <div class="success-content">
    <h4 id="successTitle">ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</h4>
    <p id="successMessage">ØªÙ… Ø§Ù„Ø·Ù„Ø¨ â€” Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„Ø¢Ù† Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙØ§ØµÙŠÙ„. Ø´ÙƒØ±Ø§Ù‹ Ù„Ø«Ù‚ØªÙƒ.</p>
    <div style="margin-top:12px;color:#d1d5db;font-size:0.95rem" id="successOrderId"></div>
    <button class="success-btn" onclick="hideSuccess()">Ø­Ø³Ù†Ø§Ù‹</button>
  </div>
</div>

<section id="about" class="product-section">
<h2>Ø­ÙˆÙ„ Hicham Market</h2>
<p>Ù…ØªØ¬Ø± Hicham Market Ù…ØªØ®ØµØµ ÙÙŠ Ø¨ÙŠØ¹ Ø¬ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª </p>
</section>

<section id="contact" class="product-section">
<h2>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h2>
<p>ğŸ“ Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ù…Ø¨Ø§Ø´Ø±Ø©: <strong>0771854064</strong></p>
<div class="social-icons">
<a href="https://wa.me/+212771854064" target="_blank" title="ÙˆØ§ØªØ³Ø§Ø¨">
<img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" alt="ÙˆØ§ØªØ³Ø§Ø¨" class="icon">
</a>
<a href="https://www.facebook.com/hicham.sh.7906" target="_blank" title="ÙÙŠØ³Ø¨ÙˆÙƒ">
<img src="https://cdn-icons-png.flaticon.com/512/733/733547.png" alt="ÙÙŠØ³Ø¨ÙˆÙƒ" class="icon">
</a>
<a href="https://www.instagram.com/insta_hicham_ox?igsh=MWx6bXJvYTU3ZjEzeQ== " target="_blank" title="Ø¥Ù†Ø³ØªØ§ØºØ±Ø§Ù…">
<img src="https://cdn-icons-png.flaticon.com/512/2111/2111463.png" alt="Ø¥Ù†Ø³ØªØ§ØºØ±Ø§Ù…" class="icon">
</a>
</div>
</section>

<script>
  // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT_ID-default-rtdb.firebaseio.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "â€¦",
    appId: "â€¦"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function openCheckout() {
    document.getElementById('checkoutModal').style.display = 'flex';
  }

  // helper: detect whether the firebase config is still the placeholder values
  function isPlaceholderConfig() {
    return (firebaseConfig.apiKey && firebaseConfig.apiKey.includes('YOUR_API_KEY')) ||
           (firebaseConfig.databaseURL && firebaseConfig.databaseURL.includes('YOUR_PROJECT_ID'));
  }

  function submitOrder() {
    const name = document.getElementById('name').value;
    const phone = document.getElementById('phone').value;
    const address = document.getElementById('address').value;

    if (!name || !phone || !address) {
      alert('ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„.');
      return;
    }

    const order = { name, phone, address, product: 'Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬', status: 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±', timestamp: Date.now() };

    // helper to build an order object compatible with stale.html
    function buildStorageOrder() {
      const id = 'ORD-' + Date.now();
      const productName = (document.querySelector('.product-section h2') || {}).textContent || 'Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬';
      const priceText = (document.querySelector('.price') || {}).textContent || '0';
      const price = parseFloat((priceText + '').replace(/[^0-9.\-]+/g, '')) || 0;
      const now = new Date();
      const date = now.toISOString().split('T')[0];
      const hh = String(now.getHours()).padStart(2, '0');
      const mm = String(now.getMinutes()).padStart(2, '0');
      const time = `${hh}:${mm}`;

      return {
        id,
        customerName: name,
        customerPhone: phone,
        customerAddress: address,
        items: [ { name: productName, price: price, quantity: 1, image: 'ğŸ›ï¸' } ],
        total: price,
        status: 'pending',
        date,
        time,
        notes: ''
      };
    }

    function saveToLocalOrders(storageOrder) {
      try {
        const stored = JSON.parse(localStorage.getItem('storeOrders') || '[]');
        stored.unshift(storageOrder);
        localStorage.setItem('storeOrders', JSON.stringify(stored));
        console.log('Order saved to localStorage (storeOrders):', storageOrder);
      } catch (e) {
        console.error('Failed to save order to localStorage:', e);
      }
    }

    // If the user didn't configure Firebase yet, use a local mocked success so the UI can be tested.
    if (isPlaceholderConfig()) {
      console.warn('Firebase appears to be placeholder config â€” using local mock for order push.');
      console.log('Order (mock):', order);
      // save compatible order to localStorage so admin (`stale.html`) can read it
      const storageOrder = buildStorageOrder();
      saveToLocalOrders(storageOrder);
      // simulate network latency and show polished success
      setTimeout(() => {
        showOrderSuccess(storageOrder.id);
        document.getElementById('checkoutModal').style.display = 'none';
        document.getElementById('name').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('address').value = '';
      }, 300);
      return;
    }

    // Real Firebase push
    db.ref('orders/').push(order)
      .then(() => {
        // also save to localStorage for admin panel view (in case admin uses storage fallback)
        try {
          const storageOrder = buildStorageOrder();
          saveToLocalOrders(storageOrder);
          // show a polished success modal with the order id
          showOrderSuccess(storageOrder.id);
        } catch (e) {
          console.warn('Could not save order to localStorage after Firebase push:', e);
          // fallback to a simple success if storage failed
          showOrderSuccess();
        }
        document.getElementById('checkoutModal').style.display = 'none';
        document.getElementById('name').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('address').value = '';
      })
      .catch(err => {
        console.error('Firebase push error:', err);
        // show a friendly error to the user
        showOrderError('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù…. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ø§Ù‹.');
      });
  }

  // show success modal
  function showOrderSuccess(orderId) {
    const modal = document.getElementById('successModal');
    const title = document.getElementById('successTitle');
    const msg = document.getElementById('successMessage');
    const idEl = document.getElementById('successOrderId');

    title.textContent = 'ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨';
    msg.textContent = 'ØªÙ… Ø§Ù„Ø·Ù„Ø¨ â€” Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„Ø¢Ù† Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙØ§ØµÙŠÙ„. Ø´ÙƒØ±Ø§Ù‹ Ù„Ø«Ù‚ØªÙƒ.';
    if (orderId) {
      idEl.textContent = `Ù…Ø±Ø¬Ø¹ Ø§Ù„Ø·Ù„Ø¨: ${orderId}`;
      idEl.style.display = 'block';
    } else {
      idEl.style.display = 'none';
    }

    modal.style.display = 'flex';
    // auto-close after 6 seconds
    setTimeout(() => {
      hideSuccess();
    }, 6000);
  }

  function hideSuccess() {
    const modal = document.getElementById('successModal');
    modal.style.display = 'none';
  }

  // show error in the same polished modal (with red text)
  function showOrderError(message) {
    const modal = document.getElementById('successModal');
    const title = document.getElementById('successTitle');
    const msg = document.getElementById('successMessage');
    const idEl = document.getElementById('successOrderId');

    title.textContent = 'Ø­Ø¯Ø« Ø®Ø·Ø£';
    msg.textContent = message || 'Ø­ØµÙ„ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹.';
    idEl.style.display = 'none';
    modal.style.display = 'flex';
  }
</script>

</body>
</html>